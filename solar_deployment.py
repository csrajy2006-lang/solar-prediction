# -*- coding: utf-8 -*-
"""solar_deployment.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1F7WYWwzeytSvTqW_PIC_o3_e96E47knk
"""

import streamlit as st
import pandas as pd
import joblib

# -----------------------------------
# Load Saved Model & Scaler
# -----------------------------------
model = joblib.load("solar_power_model.pkl")
scaler = joblib.load("solar_scaler.pkl")

st.title("ðŸŒž Solar Power Prediction App (Full Model)")

st.write("Enter all environmental and time parameters:")

# -----------------------------------
# User Inputs
# -----------------------------------

day_of_year = st.number_input("Day of Year", 1, 366)
year = st.number_input("Year", 2000, 2100)
month = st.number_input("Month", 1, 12)
day = st.number_input("Day", 1, 31)
first_hour = st.number_input("First Hour of Period (0-23)", 0, 23)

is_daylight = st.selectbox("Is Daylight?", ["Yes", "No"])
distance_solar_noon = st.number_input("Distance to Solar Noon (hours)", -12.0, 12.0)

avg_temp_day = st.number_input("Average Temperature (Day) Â°C", -10.0, 60.0)
avg_wind_direction_day = st.number_input("Average Wind Direction (Day) Â°", 0, 360)
avg_wind_speed_day = st.number_input("Average Wind Speed (Day) m/s", 0.0, 25.0)

sky_cover = st.number_input("Sky Cover (%)", 0, 100)
visibility = st.number_input("Visibility (km)", 0.0, 50.0)
relative_humidity = st.number_input("Relative Humidity (%)", 0, 100)

avg_wind_speed_period = st.number_input("Average Wind Speed (Period) m/s", 0.0, 25.0)
avg_barometric_pressure = st.number_input("Average Barometric Pressure (Period) (hPa)", 900.0, 1100.0)

# Convert Daylight
is_daylight = 1 if is_daylight == "Yes" else 0

# -----------------------------------
# Create Input DataFrame
# -----------------------------------

input_data = pd.DataFrame({
    "Day of Year": [day_of_year],
    "Year": [year],
    "Month": [month],
    "Day": [day],
    "First Hour of Period": [first_hour],
    "Is Daylight": [is_daylight],
    "Distance to Solar Noon": [distance_solar_noon],
    "Average Temperature (Day)": [avg_temp_day],
    "Average Wind Direction (Day)": [avg_wind_direction_day],
    "Average Wind Speed (Day)": [avg_wind_speed_day],
    "Sky Cover": [sky_cover],
    "Visibility": [visibility],
    "Relative Humidity": [relative_humidity],
    "Average Wind Speed (Period)": [avg_wind_speed_period],
    "Average Barometric Pressure (Period)": [avg_barometric_pressure]
})

# -----------------------------------
# Scale Input
# -----------------------------------
input_scaled = scaler.transform(input_data)

# -----------------------------------
# Prediction Button
# -----------------------------------
if st.button("ðŸ”® Predict Solar Power"):
    prediction = model.predict(input_scaled)
    st.success(f"âš¡ Predicted Solar Power: {prediction[0]:,.2f} kW")